# –ü—Ä–æ–µ–∫—Ç  
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

# –û–ø–∏—Å–∞–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: —Å–±–æ—Ä —á–µ—Ä–µ–∑ Kafka, –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –≤ Spark Streaming –∏–∑ Elasticsearch, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ ClickHouse, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ Superset. 

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Kafka (2.13-3.9.1): –°–±–æ—Ä –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.
- Spark Streaming (4.0.0): –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ Elasticsearch.
- ClickHouse (25.1.4.53): –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞.
- Superset (4.1.13): –î–∞—à–±–æ—Ä–¥—ã.
- ElasticSearch (9.0.2): –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è—Ö.



# –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

–ó–∞–¥–∞—á–∞ —Å–æ—Å—Ç–æ—è–ª–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–∏—Å—Ç–µ–º—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è. 
–ù–∞ –ø–∞—Ä–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å—Ç–∞–≤–∏—Ç—å –æ—Ç–º–µ—Ç–∫–∏ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º –∂—É—Ä–Ω–∞–ª–µ.

![alt text](refs/image_4.png)

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ —Å—Ç–∞–≤–∏—Ç—Å—è –æ—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞, –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ. 
–ù–∞ –∫–∞–∂–¥—ã–π –∫–ª–∏–∫ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥—Ç—è–≥–∏–≤–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞. –ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç —ç—Ç–æ - ElasticSearch. –í –æ–±–æ–∑—Ä–∏–º–æ–º –±—É–¥—É—é—â–µ–º –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –∏–∑ CRM —Å–∏—Å—Ç–µ–º—ã BITRIX, –∞ —Ç–∞–∫–∂–µ 1C.

–í —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∂—É—Ä–Ω–∞–ª –±—ã–ª –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω Kafka-producer, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–æ–ø–∏–∫ attendance_events.
–ü–æ—Å–ª–µ –ø–æ–ø–∞–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–æ–ø–∏–∫ –∏—Ö –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Spark Streaming.
Spark –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –∑–∞–ø–∏—Å–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –∑–∞—Ç–µ–º –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ ElasticSearch –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–µ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ. 
–î–∂–æ–∏–Ω–∏—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∂—É—Ä–Ω–∞–ª–∞ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ —Ç–æ–ø–∏–∫ attendance_enriched.

![–¢–µ—Å—Ç–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏](refs/img18.png)


### –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ 

![alt text](refs/image_5.png)

### –û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è, –≤–≤–∏–¥—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö)

![alt text](refs/image_6.png)


### üìå –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –∂—É—Ä–Ω–∞–ª–∞ –º–æ–∂–Ω–æ [–∑–¥–µ—Å—å](https://github.com/Kinnerul/gasu_enricher/blob/main/dependence/kafka/Description.md)



# –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–æ–ø–∏–∫ attendance_events, Spark Streaming –æ–±–æ–≥–∞—â–∞–µ—Ç —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∂—É—Ä–Ω–∞–ª–∞ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ ElasticSearch –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å—Ç—É–¥–µ–Ω—Ç–µ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ, –∞ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ attendance_enriched

### üìå –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –æ–±–æ–≥–æ—â–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ [–∑–¥–µ—Å—å](https://github.com/Kinnerul/gasu_enricher/blob/main/dependence/spark/DeployAndDescrip.md)



# –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∏–≤–∂–∫–æ–º KAFKA, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–ø–∏—Å–∞–Ω–∞ –Ω–∞ —Ç–æ–ø–∏–∫ attendance_enriched.

–ü–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–æ–ø–∏–∫–µ, —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª Clickhouse –∑–∞–±–∏—Ä–∞–µ—Ç –±–∞—Ç—á –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É attendance_enriched —á–µ—Ä–µ–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

### üìå –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü —Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å [–∑–¥–µ—Å—å](https://github.com/Kinnerul/gasu_enricher/blob/main/dependence/clichkouse/tables.md)



# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–¢–∞–∫ –∫–∞–∫ attendance_enriched —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–∫–∞—Ö, —Ç–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –≤–∏—Ç—Ä–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–ª–∏–∫–∏ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏, —Ç–æ –µ—Å—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

üìå –î–ª—è —ç—Ç–æ–≥–æ, —Å –ø–æ–º–æ—â—å—é –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–≤–∏–∂–∫–∞ ReplacingMergeTree –ø–æ –ø–æ–ª—é date_create —Ç–∞–±–ª–∏—Ü–∞ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ argMax –ø–æ —Ç–æ–º—É –∂–µ date_create, —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å

–ü—Ä–∏ –ø–æ–º–æ—â–∏ Clickhouse Driver –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É Superset –∏ Clickhouse.
–°–æ–∑–¥–∞–Ω Dataset –Ω–∞ –æ—Å–Ω–æ–≤–µ latest_attendance_mv.

–ë—ã–ª–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –¥–≤–∞ –¥–∞—à–±–æ—Ä–¥–∞ –ø–æ —Å—Ä–µ–∑–∞–º –ø–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º –∏ –≥—Ä—É–ø–ø–∞–º.

–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–∞—à–±–æ—Ä–¥–∞–º–∏ –º–æ–∂–Ω–æ 

### üìå –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å [–∑–¥–µ—Å—å](https://github.com/Kinnerul/gasu_enricher/blob/main/dependence/superset/visualization.md)
